env:
  AUTO: "tesla"
  XTASK_POWERSHELL_EXE: /usr/bin/pwsh

config:
  prepend-paths:
    - windows: c:/Program Files/PowerShell/7
    - /usr/local/bin
  env:
    PROJECT_DIR: "${XTASK_DIR}../../"
  delegated-dirs:
    - compose

tasks:
  test:
    uses: "powershell"
    run: |
      echo "$XTASK_POWERSHELL_EXE"
      Write-Host "Hello $($env:AUTO)"

  echo: "echo"

  set-env:
    uses: "bash"
    run: |
      echo "$XTASK_ENV"
      echo "$XTASK_PATH"
      echo 'NEW_VAR=Hello World' >> $XTASK_ENV
      echo 'SECOND_VAR=Hello Again' >> $XTASK_ENV
      echo "$HOME/.local/bin" >> $XTASK_PATH

  view-env:
    uses: "bash"
    run: |
      echo "Environment Variables:"
      echo "$NEW_VAR"
      echo "$SECOND_VAR"
      echo "PATH: $PATH"
    needs: [set-env]

  validate-cwd:
    uses: "bash"
    run: |
      echo "$PWD"
    cwd: "${XTASK_DIR}/local"

  default:
    uses: "bash"
    run: |
      echo "Hello Nurse from $ENV_TEST"
    needs: [test]

  bun:
    uses: "bun"
    run: console.log("Hello Bun")

  ruby:
    uses: "ruby"
    run: |
      puts "Hello Ruby"
      puts "Car, #{ENV['AUTO']}, is ready to go!"

  python:
    uses: "python"
    run: |
      print("Hello Python")

  ssh:
    uses: "ssh://user@10.0.6.0"
    run: |
      uptime
      echo "${HOSTNAME} is up"
      echo "Car, ${AUTO}, is ready to go!"

  docker:
    uses: "docker"
    run: test/test # This is a comment
